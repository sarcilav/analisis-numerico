%% LyX 1.6.2 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[english]{article}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{textcomp}
\usepackage{graphicx}

\usepackage{babel}

\begin{document}

\part*{Splines}


\section*{¿Que es un spline?}

Para el análisis numérico un spline es la forma mediante la cual se
puede definir una curva, mediante porciones de esta definidas por
polinomios.

Los splines hacen referencia a una amplia clase de funciones que son
utilizadas en aplicaciones que requieren la interpolación de datos,
y/o un alisado en la interpolación. Los splines son utilizados para
la interpolación y/o alisado de datos de una o varias dimensiones.
Las funciones para la interpolación por splines normalmente se determinan
como minimizadores de los cambios bruscos en las nubes de puntos.
Y además se clasifican según su capacidad de alisar las nubes de puntos.


\section*{¿Para qué se usa?}

Para el ajuste de curvas, los splines se utilizan para aproximar formas
complicadas. La simplicidad de la representación y la facilidad de
cómputo de los splines los hacen populares para la representación
de curvas en informática, particularmente en el terreno de los gráficos
por ordenador.

Además son una muy buena forma de conseguir aproximaciones computacionales
de objetos de la realidad, por ejemplo representar formas complejas
como el cuero vaca, el cuerpo humano, y en general cualquier forma
no trivial de representar mediante la composición de poliedros, polígonos,
esferas y/o círculos. Y es por esto que herramientas de CAD/CAM que
utilizan modelado, como $Rhinoceros$, $Solidworks$, $Pro/ENGINEER$ y entre otros,
hacen uso de estos para representar las complejas formas introducidas
por los diseñadores, puesto que para la máquina solo existen elementos
discretos, mientras que para ellos (diseñadores) existen las formas
llenas de curvas suaves, por lo que podemos decir que es una de las
formas mediante las cuales la computación gráfica ha logrado solventar
el eterno dilema de lo análogo vs lo digital.

También es importante resaltar que los usos de los splines no solo
se ve delimitado por la computación gráfica sino que también son usados
en problemas de optimización en economía, en sistemas de corte y en
general en cualquier sistema de ajuste de curvas. Puesto que las curvas
son una serie infinita de puntos no numerable y que tan solo nos interese
conocer las propiedades el compartimiento general de este conjunto.


\section*{Problema y solución que brindan los splines}

En la vida real cuando intentamos realizar abstracciones de la realidad,
tenemos que la realidad es infinita e inmesurable y por lo tanto
nuestros modelos son tan solo una pequeña muestra de esta, y es por
eso que precisamos un medio para poder representarla de la mejor manera,
por ejemplo en los ambientes que es necesario el reconocimiento de
patrones, para estos dispositivos es imposible captar toda la realidad
por lo que solo deben ser capaces de escoger los puntos mas significativos


\section*{Splines clásicos o trazadores}

Los splines son también llamados trazadores puesto que su utilidad
es: dada una serie de puntos, retornar el conjunto de polinomios que
punto a punto me generan una curva suave que pasa por cada uno de
estos. Por lo cual se pueden asemejar a aquellos juegos clásicos
que dado una nube de puntos ordenados, se busca generar la figura
escondida dentro de esta nube.


\subsection*{Lineales}

Esta es la forma más simple. Para estos casos lo que se busca es interpolar
una función $f(x)$, con solo $N$ pares ordenados de la forma $(x,f(x))$,
por los que debe pasar el trazador que obtengamos. Y como bien el
nombre nos lo indica cada $P_i(x)$ va hacer de la forma $ax+b$.

Ahora bien definiremos por cada par de puntos consecutivos en el orden
que nos entregaron un $P_i(x)$, para un total de $N-1$ segmentos
de recta, haciendo pasar cada una de estas por los puntos que las
definen, por lo tanto, la función $P(x)$ será una función por partes
definida por el conjunto de los $P_i$; es por ello que nuestra función
será continua en dichos puntos, pero no derivable en general, por
lo que no será una curva suave, es decir que cumplimos solo con la
parte de más trivial de los splines, nos queda por averiguar como
es que funcionan los splines que suavizan la conexión entre los diferentes
puntos.

Ejemplo : Dado los siguientes pares ordenados halle el spline.

$f(1) = 2$\inputencoding{latin1}{,}\inputencoding{latin9}$f(3) = 1$,
$f(4) = 3$

Ahora bien tenemos 3 puntos por lo tanto necesitamos calcular las
2 ecuaciones de rectas que me unen estos tres puntos.

Tenemos que:

$P_1(x) = ax + b$

\textrightarrow{}$P_1(1) = 2 = a+b$ y $P_1(3) = 1 = 3a +b$

\textrightarrow{}$a = -$${1}\over{2}$ y $b = $$5\over2$

\textrightarrow{}$P_1(x) = $${5 - x}\over{2}$

\includegraphics[scale=0.7]{img/spline_simple_1}

Ahora bien esta es la gráfica para $P_1(x)$, pero ahora necesitamos
calcular la siguiente trama. Para la cual tenemos:

$P_2(x) = ax + b$

\textrightarrow{}$P_2(3) = 1 = 3a+b$ y $P_2(4) = 3 = 4a +b$

\textrightarrow{}$a = 2$ y $b = -5$

\textrightarrow{}$P_2(x) = 2x - 5$

\includegraphics[scale=0.7]{img/spline_simple_2}


\subsubsection*{Generalización}

Para cada par de puntos adyacentes hay que resolver el siguiente
sistema matricial:

$\left[\begin{array}{cc}
x_{i-1} & 1\\
x_{i} & 1\end{array}\right]\left[\begin{array}{c}
a\\
b\end{array}\right]$$=$$\left[\begin{array}{c}
f(x_{i-1})\\
f(x_{i})\end{array}\right]$ donde $i\in\left[1,n-1\right]$ que son los $n-1$ polinomios y $\left[0,n-1\right]$
que son los $n$ puntos.

De donde se puede obtener cada uno de los $P_{i}(x)$.


\subsection*{Cuadráticos}

Un spline cuadrático es aquel que se aproxima a la función tramo por
tramo, mediante ecuaciones de la forma $P(x)=ax^{2}+bx+c$, esta es
la razón por la que se llaman cuadráticos pues son polinomios de grado
2.\\
Este tipo de spline se aplica sobre $N+1$ puntos tomando una ecuación
por cada par de puntos consecutivos, resultando así en $N$ ecuaciones
cuadráticas.\\
Se deben cumplir unas condiciones para este tipo de spline: La primera es
que para cada punto donde termina una ecuación y empieza otra, el valor de
las ecuaciones debe ser igual.
Una segunda condición es que, para obtener una curva suave, las derivadas en
cada punto de esas dos ecuaciones que pasan por él, sean iguales. Para el primer
punto se toma una segunda derivada de $0$.\\

En los spline cuadráticos cada polinomio tendrá la forma:\\
\[ P(x) = ax^2 + bx + c \]
De esa forma se obtienen dos por cada punto. Después de igualar las derivadas
se llega a tener $N$ ecuaciones de la forma:
\[ 2a_{i} + b_{i} - 2a_{i+1} + b_{i+1} = 0\]
Producto de las derivadas $\frac{\partial P}{\partial x} = 2ax + b$ en cada punto.
Se agregan las dos ecuaciones para el primer y último punto así como la derivada
hecha $0$ en el primer punto: $a = 0$.
Esto nos deja con $3N$ ecuaciones que quedan para ser resueltas mediante
cualquier método de sistemas de ecuaciones.

\subsection*{Cúbicos}

Para los spline cúbicos se tiene en cuenta la idea general de los spline
cuadráticos, donde teniendo una nube de $N+1$ puntos se deben encontrar
$N$ ecuaciones de tercer grado que una cada pareja de puntos. Estas
ecuaciones tienen la segunda derivada igual a $0$.
La primera y segunda derivada debe ser igual en cada par de puntos (desde el
punto $2$ hasta el $N$).

Los spline cúbicos aparecen de la siguiente forma:
\[ P(x) = ax^3 + bx^2 + cx + d \]
y para resolver el sistema de ecuaciones final se deben tener $4N$ ecuaciones
obtenidas de la siguiente forma:\\
 $2N-2$ ecuaciones de la forma $ P(x) = ax^3 + bx^2 + cx + d $ que unen los puntos internos.\\
 $2$ ecuaciones para los extremos que son iguales a los valores del primer y último punto.\\
 $N-1$ ecuaciones que se obtienen después de igualar las derivadas de cada una de las dos
 ecuaciones que toca cada punto interno.\\
 $N-1$ ecuaciones iguales a las de la primera derivada pero esta vez con la segunda.\\
 $2$ ecuaciones más para el primer y último punto en donde las segundas derivadas se hacen iguales a $0$.\\
 Esto nos da un total de $4N$ ecuaciones que también serán resueltas mediante un método de sistemas de ecuaciones.\\



\section*{Splines para curvas cerradas}

A simple impresión los spline cerrados, son tan solo un caso particular
de los anteriormente mencionados, pero muchos de los algoritmos y/o
métodos que se utilizan en los splines simples, no se pueden aplicar
en los splines de este tipo, puesto que un spline cerrado consiste
que el primer y último punto coinciden, lo que genera un problema
pues casi todos los métodos mencionados de splines se basan en que
el primer y último punto son diferentes para poder obtener un sistema
que no sea linealmente dependiente. Por eso es que vale la pena resaltar
este caso particular.


\subsection*{B-spline}

Los b-spline a diferencia de los spline no son trazadores puesto que
no es necesario que pasen por todos los puntos que lo definen, sino
que puede usar cada uno de esos puntos como un punto de control en
vez como un punto de una función, por lo cual son curvas mucho más
suaves (por ejemplo las curvas de Bézier).

Ahora bien los b-splines se pueden interpretar como splines paramétricos
que se redefinen a partir de un parámetro $t\in[0,1]$, expresado
como combinaciones lineales de los puntos de control, razón de que
uno de los teoremas fundamentales en este campo exprese: que dada
una función spline de un grado determinado (ejemplos: lineal, cuadrático,
cúbico... ), suavidad, y distribución de los puntos, se puede representar
como una combinación lineal de b-splines del mismo grado y suavidad,
y sobre la misma distribución de los puntos. Es decir que para un
b-spline existen puntos de anclaje ($P_{0},P_{n-1}$) y puntos de
control ($P_{1},P_{2},\cdots,P_{n-2}$), y el parámetro $t$ que indica
que el punto que se calcula con ese $t$ esta al $t*100\%$ del punto
inicial.

Ahora bien utilizaremos el mismo ejemplo de todo el documento para
explicar como se utiliza un b-spline, haciendo uso del caso particular
de las curvas de Bézier.

\[
B(t)=\sum_{i=0}^{n} {n \choose i } P_{i}\left(1-t\right)^{n-i}t^{i}\]


Y para nuestro caso particular de 3 puntos tenemos.

\[
B(t)=\sum_{i=0}^{2}{2 \choose i}P_{i}\left(1-t\right)^{2-i}t^{i}=\left(1-t\right)^{2}P_{0}+2t\left(1-t\right)P_{1}+t^{2}P_{2}\]


Con $P_{0}=\left(1,2\right),P_{1}=\left(3,1\right),P_{2}=\left(4,3\right)$
y para poder visualizar como se comporta el b-spline a medida que
avanza el $t$ tomaremos $t_{i}=\left\{ 0.2,0.4,0.5,0.6,0.8,1\right\} $,
para cada intervalo se presentará en la gráfica con un color diferente.

\includegraphics[scale=0.7]{img/b-spline_1}

\[
t=0.2\Rightarrow B(0.2)=\left(1-0.2\right)^{2}P_{0}+2*0.2\left(1-0.2\right)P_{1}+0.2^{2}P_{2}=\left(1.760;1.720\right)\]


\includegraphics[scale=0.7]{img/b-spline_2}

\[
t=0.4\Rightarrow B(0.4)=\left(1-0.4\right)^{2}P_{0}+2*0.4\left(1-0.4\right)P_{1}+0.4^{2}P_{2}=\left(2.439;1.680\right)\]


\includegraphics[scale=0.7]{img/b-spline_3}

\[
t=0.6\Rightarrow B(0.6)=\left(1-0.6\right)^{2}P_{0}+2*0.6\left(1-0.6\right)P_{1}+0.6^{2}P_{2}=\left(3.039;1.880\right)\]


\includegraphics[scale=0.7]{img/b-spline_4}

\[
t=0.8\Rightarrow B(0.8)=\left(1-0.8\right)^{2}P_{0}+2*0.8\left(1-0.8\right)P_{1}+0.8^{2}P_{2}=\left(3.559;2.319\right)\]


\includegraphics[scale=0.7]{img/b-spline_5}

\[
t=1\Rightarrow B(1)=\left(1-1\right)^{2}P_{0}+2*1\left(1-1\right)P_{1}+1^{2}P_{2}=\left(4,3\right)\]


Obviamente las curvas que se muestran anteriormente se calculan con
valores de $t$ mucho más pequeños para dar la sensación de continuidad,
los valores de $t$ era para mostrar como se va construyendo la gráfica
paso a paso.

Ahora bien tranquilamente podemos hacer un spline cerrado si agregamos
un elemento más a la lista de puntos de control $P_{n}=P_{0}$ mejor
dicho que los dos puntos de anclaje sean el mismo.


\subsection*{Naturales}

Son un caso muy particular de los splines cúbicos, puesto que la forma
más típica, consiste en hacer la segunda derivada de $P$ igual a cero
para el primer y último punto sobre el que está definido el conjunto
de Splines, pero como el primer y ultimo punto son iguales, entonces
lo que se hace para manejar esta situación es construir el spline
superior y luego el spline inferior. Y simplemente garantizar la condición
en la segunda derivada igual a cero en el primer punto en el $n/2$
por nombrar el de alguna manera al que se encuentra en la zona de
frontera entre las particiones de los splines, y luego nuevamente
garantizar que el spline $n$ que se encuentra en la parte inferior
sea igual a cero es decir que las segundas derivadas se comporten
igual para la parte de abajo y de arriba.

La forma de usar splines cúbicos ya la vimos, por lo tanto por ahora
dejaremos los splines naturales hasta aquí.


\section*{Conclusiones y selección del método}

De los dos métodos ilustrados para lograr generar splines de curvas
cerradas, hemos escogido el de spline natural por varias razones y
muchas de ellas son el descarte.
\begin{enumerate}
\item Números inmanejables: Los números generados por b-splines son dependientes
del número de puntos, por lo tanto si tenemos alrededor de 100 puntos
sería manejar flotantes con precisiones del orden de $10^{-100}$
porque los valores de $t$ que son números entre 0 y 1 serían elevados
por valores de 0 a 100, por lo tanto son valores inmanejables por
la aritmética estándar de un computador.
\item Coeficientes binomiales: También utilizados en los b-splines son números
que después de ${100 \choose i},i\in\left[0,100\right]$, son más grandes
que $10^{100}$ lo que equivale a $7.352941176470588*10^{89}$ veces
la edad del universo (trece mil seiscientos millones de años) aproximadamente.
\end{enumerate}
La complejidad de los b-splines es relativamente simple es $O(n)$
si las operaciones intermedias fueran fáciles y manejables por los
números máquinas sería la solución a escoger, pero aún así decidimos
escoger los splines naturales, que aunque se reducen a manejar matrices
de tamaños muy grandes son matrices esparcidas que se pueden reducir
a una configuración muy favorable, que permita atacar el problema
en $O(n)$ y con números manejables por la aritmética del computador.

Ahora bien podemos concluir que en el campo del análisis numérico,
un spline es una función especial definida por partes y cada una de
esas partes por polinomios. Que a su vez lo podemos ver como una forma
para manejar los problemas de interpolación.

Para la computación, y más específicamente hablando el diseño y gráficos asistido
por computador, con frecuencia se refiere a un polinomio a trozos o
curva. Como anteriormente lo hemos podido mostrar los splines se caracterizan
por su simplicidad a la hora de la construcción, su facilidad y precisión de la
evaluación, y su capacidad a la aproximación de formas complejas a
través de la curva de ajuste de curvas.

Esta aproximación a los Spline tiene el objetivo de ofrecer una introducción a
las diferentes formas de trazar líneas o curvas entre puntos, lo cual entrega
soluciones a una gran variedad de problemas de geometría computacional
que en la actualidad se encuentra también en áreas de video y animación
por computador.


\section*{Seudocódigo}


\section*{Análisis de complejidad}


\section*{Implementación }



\end{document}
